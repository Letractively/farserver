<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ever365</title>
<link rel="stylesheet" type="text/css" href="main.css"/>
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>

<link href="client/fileuploader.css" rel="stylesheet" type="text/css">	
<script src="client/fileuploader.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function() {
	var date = new Date();
	listFiles("2011-8-2");
	 var uploader = new qq.FileUploader({
         element: document.getElementById('file-uploader-demo1'),
         action: '/service/office/upload',
         debug: false,
         onComplete: function(id, fileName, responseJSON){
        	 setTimeout("$('li.qq-upload-success').fadeOut(300)", 2000);
        	 listFiles("2011-8-2");
         }
     });   
});


function listFiles(date) {
	$("#files div.fileItem").remove();
	$.getJSON("/service/office/daylist",
		{"date": date,
		"rnd":new Date().getTime()},
		function(data) {
			for(var i=0;i<data.length; i++) {
				var filed = $('div.fileItemTemplate').clone();
				filed.removeClass("fileItemTemplate").addClass("fileItem");
				filed.find('div.title').html(data[i].name);
				var dateTime = new Date(data[i].modified);
				filed.find('div.desc').html('创建于 ' + dateTime.getHours() + ":" + dateTime.getMinutes() 
						+ " 大小 " + formatSize(parseInt(data[i].size)));
				
				filed.find('a.delete').attr("bid", data[i].id)
				filed.find('a.delete').click(
					function() {
						var a = $(this);
						$.post("/service/office/delete", 
								{"id": $(this).attr("bid")},
								function(data) {
									a.parent().parent().fadeOut(300);
								}
						);
					}
				);
				filed.find('a.download').attr("href", "/d?id=" + data[i].id);
				$("#files").append(filed);
				filed.fadeIn(500);
			}
			
		}
	);
}

function formatSize(bytes){
    var i = -1;                                    
    do {
        bytes = bytes / 1024;
        i++;  
    } while (bytes > 99);
    
    return Math.max(bytes, 0.1).toFixed(1) + ['kB', 'MB', 'GB', 'TB', 'PB', 'EB'][i];          
}

</script>


</head>
<body>

<div class="wrapper" id="header_main">
	
	<div class="logged_out" id="nav_cont">
		用户:<input type="text" class="ac_input">
		密码:<input type="password" class="ac_input">
		<a href="/">登陆</a>
 		<span id="custom_join_button" class="awesome blue medium register_button link" style="margin-left: 12px;" > <a href="register.html">免费加入</a></span>
	</div>
</div>
	
<div id="logo"><img alt="Ever365 个人信息服务 " src="images/logo1ss.gif"></div>


<div id="terminal">
<div style="display:block; height: 65px">
            <ul class="nav">
                <li><a href="/" class="current">文件</a><span style="background: url(images/Folder.png)"></span></li>
                 <li><a href="/" class="current">时间</a><span style="background: url(images/Clock.png)"></span></li>
                 <li><a href="/" class="current">便签</a><span style="background: url(images/Clipboard.png)"></span></li>
                 <li><a href="/" class="current">待办</a><span></span></li>
                 <li><a href="/" class="current">更多</a><span style="background: url(images/Tools.png)"></span></li>
             </ul>
</div>             
             <div id="files">
             	<div class="itemcontainer fileItemTemplate" style="display:none">
             		<div class="image">
             			<img alt="" src="images/Folder.png">
             		</div>
             		<div class="title">我的心文件</div>
             		<div class="desc">创建于2011-2-3 12:32 大小  22K</div>
             		<div class="oper"><a href="#" class="download" target="_blank">下载</a><a href="#" class="delete">删除</a></div>
             	</div>
             	<div class="itemcontainer" style="height: auto;">
             			<div id="file-uploader-demo1">		
						<noscript>			
							<p>请启用浏览器的脚本(Javascript)</p>
						</noscript>         
					</div>
             	</div>
             </div>
             
</div>

<div style="z-index:10000;" id="toolbar_container">
	<div id="minus_toolbar" style="z-index: 10000;">
  
		<div style="float: left;" class="content" id="toolbar_left">
			<a href="http://www.ever365.com/">Ever365</a> &copy; 2009-2011
			•  
			<a href="http://blog.minus.com/category/updates/">v1.07</a>
			<span id="toolbar_links">
			• <a href="/pages/about">关于</a>
			• <a href="/pages/api">API</a>
			• <a href="/pages/tos">Terms</a>
			</span>
		</div>


	</div>
</div>
</body>
</html>
