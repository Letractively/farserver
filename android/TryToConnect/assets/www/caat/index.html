<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<script type="text/javascript" src="caat-min.js"></script>
<script type="text/javascript" src="connect.js"></script>

<script type="text/javascript">

var imageRes =  [
	{id:'d0',     url:'resource/0.png'} 
	,{id:'d1',     url:'resource/1.png'} 
	,{id:'d2',     url:'resource/2.png'}
	,{id:'d3',     url:'resource/3.png'} 
	,{id:'d4',     url:'resource/4.png'} 
	,{id:'d5',     url:'resource/5.png'} 
	,{id:'d6',     url:'resource/6.png'} 
	,{id:'d7',     url:'resource/7.png'} 
	,{id:'d8',     url:'resource/8.png'}
	,{id:'d9',     url:'resource/9.png'} 
	,{id:'d10',     url:'resource/10.png'}
];

var loadedRes = {};

function aa() {
	var director_1 = new CAAT.Director().initialize(
	        600,420,
	        document.getElementById('_c1'));
	 
	var scene_1= director_1.createScene().setFillStyle('#fff');
	 
	// make the scene clear background and draw a black rectangle
	scene_1.paint= function(director, time) {
	    var ctx= director.ctx;
	    ctx.fillStyle= this.fillStyle;
	    ctx.fillRect(0,0,this.width,this.height);
	    ctx.strokeStyle= '#000';
	    ctx.strokeRect(0,0,this.width-1,this.height-1);
	}
	 
	 
	// create six actors for this scene.
	for(var i=0; i<10; i++ ) {
	 
	    // rectangle shaped actors of 80x80 pixels.
	    var s = 80;
	 
	    // containers can contain other actors or containers.
	    var _c1_container = new CAAT.ActorContainer().
	            setBounds((i%6)*100+10, 20, s, s).
	            setRotation( Math.PI*2*Math.random() ).
	            setFillStyle('#ff3fff').
	            enableDrag();
	 
	    _c1_container.name = 'rectangle'+i;
	    // set container paint routine to draw an arrow
	    _c1_container.paint= function(director, time) {
	 
	        var crx= director.ctx;
	 
	        // fill actor
	        crx.fillStyle= this.fillStyle;
	        crx.fillRect(0,0,this.width,this.height );
	 
	        // outline it.
	        crx.strokeStyle= 'black';
	        crx.strokeRect(0,0,this.width,this.height );
	 
	        // draw a white arrow. just to point where position 0,0 is.
	        crx.strokeStyle='white';
	        crx.beginPath();
	        crx.moveTo(5,10);
	        crx.lineTo(20,10);
	        crx.lineTo(15,5);
	 
	        crx.moveTo(20,10);
	        crx.lineTo(15,15);
	 
	        crx.lineWidth=2;
	        crx.lineJoin='round';
	        crx.lineCap='round';
	 
	        crx.stroke();
	    };
	 
	    // add actor to scene.
	    scene_1.addChild(_c1_container);
	 
	    // create a container.
	    var _c1_container_child= new CAAT.ActorContainer().
	            setBounds(s/2,s/2,s/4,s/4).
	            setRotation( Math.PI*2*Math.random() ).
	            setFillStyle('#00ff00').
	            enableDrag();
	 
	    // set a custom paint function for children inside containers.
	    _c1_container_child.paint= function(director,time) {
	        // call default container paint method.
	        CAAT.ActorContainer.superclass.paint.call(this,director,time);
	        var ctx= director.ctx;
	 
	        // fill a white circle of 10x10 pixels at position 2,2
	        // just to show where 0,0 is positioned on screen.
	        ctx.fillStyle='white';
	        ctx.beginPath();
	        ctx.arc(7,7,5,0,2*Math.PI,false);
	        ctx.fill();
	    }
	 
	 
	    // add this container as a child of the previous created container.
	    _c1_container.addChild(_c1_container_child);
	}
	 
	// set animation to 10fps.
	CAAT.loop(20);
	
}

var anchor= [
             0,0,    .50,0,   1.00,0,
             0,.50,  .50,50,  1.00,.50,
             0,1.00, .50,100, 1.00,1.00
         ];
          

var sceneArray = [
                  ['3','4','5','6','7'],[1,1,1,1,1]
              ];

function drawArray(ary, container) {
	
}


var rotateLeft= new CAAT.RotateBehavior().
	setCycle(true).
	setPingPong().
	setFrameTime( 0, 1000 ).
	setValues(0, 0.03*Math.PI, 1,1);


var total = 0;
function cc() {
	var director = new CAAT.Director().initialize(
	        700,700,
	        document.getElementById('_c1'));
	
	var scene= director.createScene();
	
	var bg = new CAAT.ActorContainer().
    	setBounds(0,0,director.width,director.height).
    	setFillStyle('#fff');
	
	scene.addChild(bg);
	 
	 new CAAT.ImagePreloader().loadImages(
			 imageRes,
			function(counter, images) {
				 alert(1);
				director.setImagesCache(images);
			
				var ary = wrapArray(generateRandomArray(10,10));
				for(var i=0; i<ary.length; i++) {
					for(var j=0; j<ary[i].length; j++) {
						if (ary[i][j]=='') continue;
						
						var v = 'd' + ary[i][j];
						
						var starsImage = new CAAT.SpriteImage().initialize(director.getImage(v), 1,1);
						
						var actorStar = new CAAT.Actor().setBackgroundImage(starsImage.getRef(), true)
						.setBounds(i*50, j*50 , 48,48)
						bg.addChild(actorStar);
						total ++;
						actorStar.mouseDown = spriteMouseDown;
					}
				}
				
				/*
				for(var i=0; i<20; i++) {
					var actorStar = new CAAT.Actor().setBackgroundImage(starsImage.getRef(), true).enableDrag()
						//.addBehavior(rotateLeft)
						.setBounds(100*(i%5), 30 * (i/5), 48,48);
					stars.push(actorStar);
					bg.addChild(actorStar);
				}
				*/
			}
	);
	CAAT.loop(60);
}

function spriteMouseDown(me) {
	me.source.setDiscardable(true)
	.setExpired(0);
	/*
	me.source.addBehavior(rotateLeft);
	if (clicked.contains(me.source)) {
	
	} else {
		clicked.push(me.source);
	}
	*/
	
	
}

</script>
</head>
<body onload="cc()">
 <canvas id="_c1"></canvas>
</body>
</html>